$(document).ready((function(){var e=$("#faq-typeahead"),t=$("#student-helper"),n=$("input.course-typeahead"),i=$("input.az-typeahead"),a=$("input.subject-typeahead"),s=$("input.database-subject-typeahead"),o=function(e){return{highlight:!0,minLength:e=e||0,classNames:{highlight:"font-weight-bold",dataset:"tt-dataset list-group",menu:"tt-menu small text-dark scrollable",cursor:"tt-cursor"}}};if(e.length){var r=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("question","topics"),queryTokenizer:Bloodhound.tokenizers.whitespace,identify:function(e){return e.question},remote:{url:libutils.sprinshareUrls.answer_faqs,wildcard:"%QUERY",prepare:function(e,t){return t.dataType="jsonp",t.url=t.url.replace("%QUERY",e),t},transform:function(e){return $.map(e.data.search.results,(function(e){var t=$.map(e.topics,(function(e,t){return[e]}));return{id:e.id,question:e.question,topics:t.join(", "),url:e.url}}))}}});e.typeahead(o(1),{name:"faqList",source:r,display:"question",limit:200,templates:{suggestion:function(e){return'<div class="list-group-item list-group-item-action">'+e.question+"</div>"},header:function(){return'<div class="list-group-item list-group-item-info">Showing FAQs that contain one or more of your keywords. Don\'t see a relevant question? Refine your terms or <a class="text-dark font-weight-bold" href="/ask-us/">Ask Us</a>.</div>'},notFound:function(){return'<div class="list-group-item list-group-item-dark">Don\'t see what you\'re looking for?. <a class="text-dark font-weight-bold" href="/ask-us/">Ask Us</a> and we\'ll respond with 24-48 hours.</div>'}}}).on("typeahead:selected",(function(e,t){ga("send","event","link - typeahead","faq",t.question,{hitCallback:libutils.actWithTimeOut((function(){libutils.goToUrl(t)}))})}))}if(a.length||s.length){var l=function(e,t){""===e?t(u.index.all()):u.search(e,t)},u=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:{url:libutils.sprinshareUrls.subjects_list,cache:!0,transform:function(e){return $.map(e,(function(e){return{id:e.id,name:e.name}}))}}});a.typeahead(o(0),{name:"allSubjects",source:l,display:"name",limit:200,templates:{suggestion:function(e){return'<div class="list-group-item d-flex justify-content-between align-items-center" role="link"><div>'+e.name+'</div><i class="fas fa-external-link-alt" aria-hidden="true" title="external link to '+e.name+'"></i></div>'}}}).on("typeahead:selected",(function(e,t){ga("send","event","link - typeahead","subjects",t.name,{hitCallback:libutils.actWithTimeOut((function(){libutils.goToSubjectUrl(t,"//guides.library.unt.edu/sb.php?subject_id=")}))})})),s.typeahead(o(0),{name:"allSubjects",source:l,display:"name",limit:200,templates:{suggestion:function(e){return'<div class="list-group-item d-flex justify-content-between align-items-center" role="link"><div>'+e.name+'</div><i class="fas fa-external-link-alt" aria-hidden="true" title="external link to '+e.name+'"></i></div>'}}}).on("typeahead:selected",(function(e,t){ga("send","event","link - typeahead","subjects - databases",t.name,{hitCallback:libutils.actWithTimeOut((function(){libutils.goToSubjectUrl(t,"//guides.library.unt.edu/az.php?s=")}))})}))}if(i.length){var d,c=function(){return d=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name","description","new","trial","subjects","alt_names"),queryTokenizer:Bloodhound.tokenizers.whitespace,identify:function(e){return e.id},local:JSON.parse(sessionStorage.getItem("springshareAzWithSubjects"))})},p=new Date;null===sessionStorage.getItem("springshareAzWithSubjects")||p.getTime()>sessionStorage.getItem("springshareAzExpires")?(i.attr("placeholder","loading suggestions!"),$.when($.get(libutils.sprinshareUrls.databases)).done((function(e){var t=$.map(e,(function(e){var t=e.description.replace(/<\/?[^>]+>/gi,"").replace(/"/g,"'"),n=+e.meta.enable_proxy?"https://libproxy.library.unt.edu/login?url="+e.url:e.url,i=1===e.enable_new?"recently added":"",a=1===e.enable_trial?"under consideration":"",s=e.hasOwnProperty("subjects")?e.subjects:[],o=s.length?"<br /><strong>Subjects: </strong>":"";return o+=s.map((function(e){return e.name})).join(", "),{id:e.id,name:e.name,description:t,url:n,new:i,trial:a,subjects:o,alt_names:e.alt_names}}));sessionStorage.setItem("springshareAzWithSubjects",JSON.stringify(t));var n=p.getTime()+864e5;sessionStorage.setItem("springshareAzExpires",n),c(),i.attr("placeholder","type for suggestions")}))):c(),i.typeahead(o(0),{name:"azList",minLength:2,source:function(e,t){""===e?t(d.get([2477452,2478596,2479459,2477894,2478101,2478940])):d.search(e,t)},limit:50,display:"name",templates:{suggestion:function(e){var t=e.new?'<span class="badge badge-info small align-self-center">new</span>':"",n=e.trial?'<span class="badge badge-info small align-self-center">trial</span>':"";return'<div class="list-group-item d-flex" role="link"><div class="flex-grow-1">'.concat(e.name,"</div>")+t+n+'<i class="fas fa-info pl-3 d-none d-md-inline-block align-self-center" data-database="description" data-content="'.concat(e.description," ").concat(e.subjects,' " title="').concat(e.name,'" id="lg-id-').concat(e.id,'" aria-hidden="true"></i>')+"</div>"},notFound:function(){return'<div class="list-group-item">No match found. Try alternatives or use fewer terms</div>'}}}).on("focusin",(function(){$(this).attr("placeholder","try these best bets or search for your own.")})).on("focusout",(function(){$(this).attr("placeholder","type for suggestions")})).on("typeahead:selected",(function(e,t){ga("send","event","link - typeahead","database",t.name,{hitCallback:libutils.actWithTimeOut((function(){libutils.goToUrl(t)}))})}));var h=$("#recent-dbs"),m=$("#trial-dbs");h.on("click",(function(e){e.preventDefault(),$("#az-search").typeahead("val","recently added").focus()})),m.on("click",(function(e){e.preventDefault(),$("#az-search").typeahead("val","under consideration").focus()}));$("div.database-group").popover({container:"body",trigger:"hover",selector:'[data-database="description"]',boundary:"viewport",placement:"right",html:!0}).on("inserted.bs.popover",(function(e){var t=$(e.target).closest(".twitter-typeahead").find(".tt-input").val(),n=t.split(" "),i=$("body").find(".popover-body");t.length&&window.Mark&&i.mark(n,{element:"strong",className:"text-success p-1"})}))}if(t.length||n.length){var g=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name","description","subjects","type_machine"),queryTokenizer:Bloodhound.tokenizers.whitespace,identify:function(e){return e.name},prefetch:{url:libutils.sprinshareUrls.guides_expand_owner_subject,cache:!0,transform:function(e){return $.map(e,(function(e){var t=$.map(e.subjects,(function(e,t){return[e.name]}));return{id:e.id,name:e.name,description:e.description,url:e.friendly_url||e.url,type_label:e.type_label,type_machine:e.type_label.toLowerCase().replace(" ","-").concat("-",e.type_id),subjects:t.join(", ")}}))}}});n.typeahead(o(0),{name:"coursesSource",source:function(e,t){g.search(e+" course-guide-2",t)},display:"name",limit:500,templates:{suggestion:function(e){return'<div class="list-group-item d-flex justify-content-between align-items-center" role="link"><div>'+e.name+'</div><i class="fas fa-external-link-alt" aria-hidden="true" title="external link to '+e.name+'"></i></div>'}}}).on("typeahead:selected",(function(e,t){ga("send","event","link - typeahead","courses",t.name,{hitCallback:libutils.actWithTimeOut((function(){libutils.goToUrl(t)}))})}));var f=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("name","job_title","liaison_notes","academic_units_string","subjects"),queryTokenizer:Bloodhound.tokenizers.whitespace,prefetch:libutils.siteDomain+"/assets/data/subject-librarians.json"});t.typeahead(o(0),{name:"librarians",source:f,display:"name",templates:{suggestion:function(e){return'<div class="list-group-item list-group-item-action d-flex align-items-center"><div><h5 class="h6">'+e.name+" <small> &mdash; "+e.job_title+"</small></h5><strong>Phone: </strong>"+e.phone+"<br /><strong>Serving: </strong>"+e.academic_units_served+'</div><span class="ml-auto badge badge-dark">subject librarian</span></div></div>'}}},{name:"allLibGuides",source:g,display:"name",limit:20,templates:{suggestion:function(e){var t;return t="Course Guide"===e.type_label?"info":"success",'<div class="list-group-item list-group-item-action d-flex align-items-center"><div>'+e.name+'</div><span class="ml-auto badge badge-'+t+'">'+e.type_label+"</span></div>"}}}).on("typeahead:selected",(function(e,t){ga("send","event","link - typeahead","student helper - "+t.type_label,t.name,{hitCallback:libutils.actWithTimeOut((function(){libutils.goToUrl(t)}))})}))}}));